## Lua编译

[toc]

从Lua的官网下载源码，然后解压，找到里面的src文件。

我们需要编译的东西有三个：

1. dll和lib   ---->lua库
2. lua.exe  ---->lua解释器
3. luac.exe ---->lua编译器

## 编译Dll和Lib

右键项目解决方案，然后在属性里面，创建一个名为liblua的project（lua库），添加除lua.c和luac.c以外的所有代码文件，将lua库编译为dll。预处理器中添加LUA_BUILD_AS_DLL。

上面说的简略内容在这里详细说一下具体在那里配置，首先右键解决方案，选择属性：

1. 常规->项目默认值->配置类型->选择动态库
2. VC++目录->包含目录->编辑添加lau源码的src目录
3. C/C++->预处理器->预处理器定义中添加LUA_BUILD_AS_DLL。
4. 回到我们的解决方案，右键源文件，添加现有项，将lua源码src目录中除了lua.c和luac.c以外的所有.c结尾代码文件添加

## 编译lua解释器

首先右键解决方案，选择属性：

1. 常规->项目默认值->配置类型->选择.exe
2. VC++目录->包含目录->编辑添加lau源码的src目录

右键源文件，添加现有项，将lua源码src目录中除了luac.c以外的所有.c结尾代码文件添加，build。



## 编译lua编译器

首先右键解决方案，选择属性：

1. 常规->项目默认值->配置类型->选择.exe
2. VC++目录->包含目录->编辑添加lau源码的src目录

右键源文件，添加现有项，将lua源码src目录中除了lua.c以外的所有.c结尾代码文件添加，build。

## 使用库文件编写lua

我们可以把上面生成的库和可执行问价抽出来，放到一个目录下，方便我们配置使用。

首先右键解决方案，选择属性：

1. 常规->项目默认值->配置类型->选择.exe
2. VC++目录->包含目录->编辑添加lau源码的src目录
3. VC++目录->库目录->编辑添加上面生成的lua.lib所在的文件夹
4. 链接器->输入->附加依赖项->编辑添加我们生成的lua.lib
5. 还有我们需要把我们的lua.dll拷贝到项目生成的.exe目录下，这样才能够执行

**我们可以先编译生成.exe文件，然后将lua.dll拷贝过去，因为编译不需要dll文件，运行才需要。**

